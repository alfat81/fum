<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- [ДОБАВЛЕНО] Мета-описание для SEO -->
    <meta name="description" content="Официальные документы Комиссии по фигурному управлению мотоциклом: правила соревнований, регламенты, лицензии и нормативные акты.">
    <title>Полезные документы | Комиссия по фигурному управлению мотоциклом | МФР</title>
    <link rel="stylesheet" href="style.css">
    <!-- [ДОБАВЛЕНО] Preconnect для ускорения загрузки шрифтов -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <!-- [ДОБАВЛЕНО] Скринридер-доступный заголовок -->
    <h1 class="visually-hidden">Полезные документы Комиссии по фигурному управлению мотоциклом</h1>
    <div class="container">
        <header class="header">
            <div class="logo-container">
                <!-- [ОПТИМИЗИРОВАНО] Логотип теперь кликабельный и ведет на главную -->
                <a href="index.html" class="logo-link" aria-label="На главную страницу">
                    <div class="logo-left">
                        <img src="images/logo_sm.png" alt="Логотип Комиссии по фигурному управлению мотоциклом" class="logo-img" width="80" height="80">
                    </div>
                    <div class="logo-right">
                        <div class="official-name">МОТОЦИКЛЕТНАЯ ФЕДЕРАЦИЯ РОССИИ</div>
                        <div class="commission-name">КОМИССИЯ ПО ФИГУРНОМУ УПРАВЛЕНИЮ МОТОЦИКЛОМ (МОТОДЖИМХАНА)</div>
                    </div>
                </a>
            </div>
            <button class="menu-toggle" aria-label="Открыть меню" aria-expanded="false" aria-controls="mobile-nav">
                <i class="fas fa-bars" aria-hidden="true"></i>
            </button>
            <nav class="main-nav" aria-label="Основная навигация">
                <ul>
                    <li><a href="index.html" class="nav-link">Главная</a></li>
                    <li><a href="about.html" class="nav-link">О комиссии</a></li>
                    <li><a href="structure.html" class="nav-link">Структура комиссии</a></li>
                    <li><a href="calendar.html" class="nav-link">Календарь соревнований</a></li>
                    <li><a href="documents.html" class="nav-link active" aria-current="page">Полезные документы</a></li>
                    <li><a href="contacts.html" class="nav-link">Контакты</a></li>
                    <li><a href="partners.html" class="nav-link">Партнеры</a></li>
                </ul>
            </nav>
            
            <!-- Mobile menu -->
            <nav class="mobile-menu" id="mobile-nav" aria-label="Мобильная навигация">
                <div class="mobile-nav">
                    <ul>
                        <li><a href="index.html" class="nav-link">Главная</a></li>
                        <li><a href="about.html" class="nav-link">О комиссии</a></li>
                        <li><a href="structure.html" class="nav-link">Структура комиссии</a></li>
                        <li><a href="calendar.html" class="nav-link">Календарь соревнований</a></li>
                        <li><a href="documents.html" class="nav-link active" aria-current="page">Полезные документы</a></li>
                        <li><a href="contacts.html" class="nav-link">Контакты</a></li>
                        <li><a href="partners.html" class="nav-link">Партнеры</a></li>
                    </ul>
                </div>
            </nav>
        </header>

        <main class="content">
            <h1 class="page-title">Полезные документы</h1>
            
            <section class="documents-section" aria-labelledby="documents-heading">
                <div class="documents-info">
                    <p><i class="fas fa-info-circle" aria-hidden="true"></i> Все документы доступны для скачивания ниже. Для получения новых документов обратитесь к администрации комиссии.</p>
                    <p>Для загрузки новых документов используйте панель администратора.</p>
                </div>
                
                <div class="documents-filters" role="group" aria-label="Фильтры документов">
                    <button class="filter-btn active" data-filter="all">Все документы</button>
                    <button class="filter-btn" data-filter="rules">Правила</button>
                    <button class="filter-btn" data-filter="regulations">Регламенты</button>
                    <button class="filter-btn" data-filter="licenses">Лицензии</button>
                    <button class="filter-btn" data-filter="other">Прочее</button>
                </div>
                
                <div class="documents-grid" id="documents-container" role="list" aria-label="Список документов">
                    <!-- Документы будут загружены из localStorage -->
                </div>
            </section>
        </main>

        <footer class="footer" aria-label="Подвал сайта">
            <div class="footer-logos">
                <a href="https://www.mfr.ru/" target="_blank" rel="noopener noreferrer">
                    <img src="images/mfr_logo.png" alt="Логотип Мотоциклетной Федерации России" width="100" height="60">
                </a>
                <a href="https://www.minsport.gov.ru/" target="_blank" rel="noopener noreferrer">
                    <img src="images/logo_minsport.png" alt="Логотип Министерства спорта Российской Федерации" width="100" height="60">
                </a>
            </div>
            <div class="footer-links">
                <a href="documents.html" class="document-link">Документы комиссии</a>
                <a href="https://www.mfr.ru/" target="_blank" rel="noopener noreferrer">Официальный сайт МФР</a>
                <a href="https://www.mfr.ru/disciplines/motodzhimkhana/" target="_blank" rel="noopener noreferrer">Страница мотоджимханы на сайте МФР</a>
            </div>
            <div class="copyright">
                © 2025 Мотоциклетная Федерация России
            </div>
        </footer>
    </div>

    <!-- Модальное окно для просмотра документа -->
    <div class="modal" id="document-modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="modal-title" hidden>
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Просмотр документа</h2>
                <button class="close-modal" id="close-modal" aria-label="Закрыть модальное окно">
                    <i class="fas fa-times" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-body">
                <iframe id="document-viewer" title="Просмотрщик документа" style="width:100%; height:500px; border:none;"></iframe>
                <p class="modal-help" id="modal-help">
                    Если документ не отображается, вы можете <a href="#" id="modal-download-link" download>скачать его</a>.
                </p>
            </div>
        </div>
    </div>

    <!-- Admin tab -->
    <!-- [ОПТИМИЗИРОВАНО] Админ-панель скрыта от индексации и вспомогательных технологий -->
    <div class="admin-tab" id="admin-tab" aria-hidden="true" tabindex="-1" role="button" aria-label="Открыть панель администратора">
        <i class="fas fa-cog" aria-hidden="true"></i>
    </div>

    <div class="admin-panel" id="admin-panel" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Панель администратора" hidden>
        <!-- Содержимое админ-панели осталось без изменений, но скрыто атрибутом hidden и управляется JS -->
        <div class="admin-header">
            <h2>Админ-панель</h2>
            <button class="close-admin-panel" id="close-admin-panel" aria-label="Закрыть панель администратора">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
        </div>
        <!-- ... остальное содержимое админ-панели без изменений ... -->
    </div>

    <script src="script.js" defer></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Инициализация модального окна
            const modal = document.getElementById('document-modal');
            const closeModalBtn = document.getElementById('close-modal');
            const documentViewer = document.getElementById('document-viewer');
            const modalDownloadLink = document.getElementById('modal-download-link');
            const modalHelp = document.getElementById('modal-help');
            
            // Функции для работы с модальным окном
            const openModal = (documentUrl, documentName, documentType) => {
                modal.removeAttribute('hidden');
                modal.setAttribute('aria-hidden', 'false');
                document.body.style.overflow = 'hidden'; // Блокируем прокрутку страницы
                
                // Устанавливаем заголовок
                document.getElementById('modal-title').textContent = documentName;
                
                // Для PDF файлов используем встроенный просмотр
                if (documentType === 'pdf') {
                    documentViewer.style.display = 'block';
                    documentViewer.src = documentUrl;
                    modalHelp.style.display = 'block';
                    modalDownloadLink.href = documentUrl;
                    modalDownloadLink.download = documentName + '.pdf';
                } else {
                    // Для других форматов показываем сообщение
                    documentViewer.style.display = 'none';
                    modalHelp.innerHTML = `
                        <p>Данный формат документа (${documentType.toUpperCase()}) не поддерживает просмотр в браузере.</p>
                        <p>Вы можете <a href="${documentUrl}" download="${documentName}.${documentType}">скачать документ</a> для просмотра на вашем устройстве.</p>
                    `;
                }
            };
            
            const closeModal = () => {
                modal.setAttribute('hidden', '');
                modal.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = 'auto'; // Возвращаем прокрутку
                documentViewer.src = ''; // Очищаем iframe
            };
            
            // Закрытие модального окна
            closeModalBtn.addEventListener('click', closeModal);
            
            // Закрытие при клике вне модального окна
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });
            
            // Закрытие по клавише Escape
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !modal.hasAttribute('hidden')) {
                    closeModal();
                }
            });
            
            // Фильтрация документов
            const filterButtons = document.querySelectorAll('.filter-btn');
            
            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Убираем активный класс со всех кнопок
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    // Добавляем активный класс к текущей кнопке
                    this.classList.add('active');
                    
                    const filter = this.getAttribute('data-filter');
                    filterDocuments(filter);
                });
            });
            
            // Загрузка документов из localStorage
            function loadDocuments() {
                const documentsContainer = document.getElementById('documents-container');
                const documents = getDocuments();
                
                documentsContainer.innerHTML = '';
                
                if (documents.length === 0) {
                    documentsContainer.innerHTML = '<p class="no-documents">Нет доступных документов</p>';
                    return;
                }
                
                documents.forEach(doc => {
                    documentsContainer.appendChild(createDocumentCard(doc));
                });
            }
            
            // Получение документов из localStorage
            function getDocuments() {
                try {
                    const savedDocuments = localStorage.getItem('documentsList');
                    return savedDocuments ? JSON.parse(savedDocuments) : getDefaultDocuments();
                } catch (error) {
                    console.error('Ошибка при загрузке документов:', error);
                    return getDefaultDocuments();
                }
            }
            
            // Демонстрационные документы
            function getDefaultDocuments() {
                return [
                    {
                        id: 1,
                        name: 'Правила соревнований по фигурному управлению мотоциклом',
                        url: '#',
                        category: 'rules',
                        date: '15.01.2025',
                        size: '1.2 МБ',
                        type: 'pdf'
                    },
                    {
                        id: 2,
                        name: 'Регламент Кубка России 2025',
                        url: '#',
                        category: 'regulations',
                        date: '20.11.2024',
                        size: '2.4 МБ',
                        type: 'pdf'
                    },
                    {
                        id: 3,
                        name: 'Порядок оформления спортивных лицензий',
                        url: '#',
                        category: 'licenses',
                        date: '10.01.2025',
                        size: '0.8 МБ',
                        type: 'pdf'
                    },
                    {
                        id: 4,
                        name: 'Требования к экипировке',
                        url: '#',
                        category: 'rules',
                        date: '30.11.2024',
                        size: '0.9 МБ',
                        type: 'pdf'
                    },
                    {
                        id: 5,
                        name: 'Положение о проведении соревнований',
                        url: '#',
                        category: 'regulations',
                        date: '05.12.2024',
                        size: '1.5 МБ',
                        type: 'pdf'
                    },
                    {
                        id: 6,
                        name: 'Медицинские требования',
                        url: '#',
                        category: 'licenses',
                        date: '15.01.2025',
                        size: '0.7 МБ',
                        type: 'pdf'
                    }
                ];
            }
            
            // Создание карточки документа
            function createDocumentCard(document) {
                const docCard = document.createElement('article');
                docCard.className = `document-card ${document.category}`;
                docCard.setAttribute('aria-label', `Документ: ${document.name}`);
                
                // Определяем, поддерживается ли просмотр в браузере
                const canPreview = ['pdf'].includes(document.type.toLowerCase());
                
                // Создаем кнопки действий
                let actionButtons = '';
                
                if (canPreview && document.url !== '#') {
                    actionButtons += `
                        <button class="document-link view-link" data-id="${document.id}" aria-label="Просмотреть документ ${document.name}">
                            <i class="fas fa-eye" aria-hidden="true"></i> Просмотреть
                        </button>
                    `;
                }
                
                actionButtons += `
                    <a href="${document.url}" class="document-link download-link" download="${document.name}.${document.type}" aria-label="Скачать документ ${document.name}">
                        <i class="fas fa-download" aria-hidden="true"></i> Скачать
                    </a>
                `;
                
                docCard.innerHTML = `
                    <div class="document-icon" aria-hidden="true">
                        <i class="${getCategoryIcon(document.category)}"></i>
                    </div>
                    <h3 class="document-title">${document.name}</h3>
                    <div class="document-meta">
                        <span class="document-date">${document.date}</span>
                        <span class="document-size">${document.size}</span>
                        <span class="document-type">${document.type.toUpperCase()}</span>
                    </div>
                    <div class="document-actions">
                        ${actionButtons}
                    </div>
                `;
                
                // Добавляем обработчик для кнопки просмотра
                if (canPreview && document.url !== '#') {
                    const viewBtn = docCard.querySelector('.view-link');
                    viewBtn.addEventListener('click', () => {
                        openModal(document.url, document.name, document.type);
                    });
                }
                
                return docCard;
            }
            
            // Получение иконки по категории
            function getCategoryIcon(category) {
                const icons = {
                    'rules': 'fas fa-balance-scale',
                    'regulations': 'fas fa-calendar-alt',
                    'licenses': 'fas fa-id-card',
                    'other': 'fas fa-file-alt'
                };
                return icons[category] || 'fas fa-file-alt';
            }
            
            // Фильтрация документов
            function filterDocuments(filter) {
                const documentsContainer = document.getElementById('documents-container');
                const documents = getDocuments();
                
                documentsContainer.innerHTML = '';
                
                const filteredDocuments = filter === 'all' 
                    ? documents 
                    : documents.filter(doc => doc.category === filter);
                
                if (filteredDocuments.length === 0) {
                    documentsContainer.innerHTML = '<p class="no-documents">Документы не найдены</p>';
                    return;
                }
                
                filteredDocuments.forEach(doc => {
                    documentsContainer.appendChild(createDocumentCard(doc));
                });
            }
            
            // Начальная загрузка документов
            loadDocuments();
            
            // [ОПТИМИЗАЦИЯ] Анимация появления документов
            const animateDocuments = () => {
                const documents = document.querySelectorAll('.document-card');
                const screenPosition = window.innerHeight / 1.3;
                
                documents.forEach((doc, index) => {
                    const docPosition = doc.getBoundingClientRect().top;
                    
                    if (docPosition < screenPosition) {
                        doc.style.opacity = '1';
                        doc.style.transform = 'translateY(0)';
                        doc.style.transitionDelay = `${index * 0.1}s`;
                    }
                });
            };
            
            // Установка начальных стилей для анимации
            const documentCards = document.querySelectorAll('.document-card');
            documentCards.forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            });
            
            // Вызов анимации при загрузке и прокрутке
            setTimeout(animateDocuments, 300);
            window.addEventListener('scroll', animateDocuments);
        });
    </script>
</body>
</html>
